import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.annotation.WebServlet;
import java.sql.*;

@WebServlet("/servlet/ListerP")
public class ListerP extends HttpServlet 
{
	public void service( HttpServletRequest req, HttpServletResponse res)
	throws ServletException, IOException
	{   
		res.setContentType("text/html;charset=UTF-8");
		PrintWriter out = res.getWriter();
		out.println( "<html><body>");
		out.println( "<h1>ListerP</h1>" );
		out.println("<table border =\"1\">");
		try{
			String url = "jdbc:postgresql://psqlserv/n3p1";
			Connection con=null;
			String query = "select * from personne";
			Class.forName("org.postgresql.Driver");
				con = DriverManager.getConnection(url, "massiaua", "moi");
			Statement stmt = con.createStatement();
			ResultSet rs = stmt.executeQuery(query);
			
			out.println("<h1>Liste des personnes:</h1>");

			while(rs.next()){
			    int id=rs.getInt("id");
			    String nom=rs.getString("nom");
			    String prenom=rs.getString("prenom");

			    out.println("<tr><td>"+id+"</td><td>"+nom+"</td><td>"+prenom+"</td></tr");

			}
			out.println("</table>");
		}catch(Exception e){
		    out.println(e.getMessage());
		}finally{
		    con.close();
	        }	
		out.println( "</body></html>" );
	}
}

